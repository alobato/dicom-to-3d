(this.webpackJsonpfront=this.webpackJsonpfront||[]).push([[0],{214:function(e,t,n){e.exports=n(534)},221:function(e,t,n){},223:function(e,t,n){},229:function(e,t,n){},528:function(e,t,n){},530:function(e,t,n){},531:function(e,t,n){},532:function(e,t,n){},534:function(e,t,n){"use strict";n.r(t);var a,c,l,r=n(206),o=n(0),u=n.n(o),s=n(62),i=n.n(s),m=n(34),d=n(45),E=n(19),b=n(212),f=n(213),h=n(31),p=n(32),g=n(70),O=n(63),v=n(71),S=n(537),j=(n(221),n(18));!function(e){e[e.success=0]="success",e[e.fail=1]="fail",e[e.building=2]="building"}(a||(a={})),function(e){e.SUBSCRIBE="SUBSCRIBE",e.SUBSCRIPTION="SUBSCRIPTION",e.UNSUBSCRIPTION="UNSUBSCRIPTION",e.REQUEST="REQUEST",e.RESPONSE="RESPONSE",e.EVENT="EVENT"}(c||(c={})),function(e){e.START_BUILD="START_BUILD",e.BUILD_RESULT="BUILD_RESULT",e.BUILD_RESULTS="BUILD_RESULTS"}(l||(l={}));var I=n(541),N=(n(223),Object(j.cn)("StatusIcon")),R=function(e){var t=e.status;return u.a.createElement("span",{className:N()},t===a.building?u.a.createElement(I.a,{className:N({MdAutorenew:!0})}):t===a.success?u.a.createElement(I.b,null):t===a.fail?u.a.createElement(I.c,null):u.a.createElement("div",null))},T=Object(j.cn)("BuildTable-Row"),U=function(e){var t=e.buildId,n=e.status,c=e.repositoryOwner,l=e.repositoryName,r=e.commitHash,u=Object(E.f)().push;return o.createElement("tr",{onClick:function(){return u("build/".concat(t))},className:T({success:n===a.success,fail:n===a.fail,building:n===a.building})},o.createElement("td",null,t),o.createElement("td",null,o.createElement(R,{status:n})),o.createElement("td",null,c),o.createElement("td",null,l),o.createElement("td",null,r))},B=function(){return o.createElement("thead",null,o.createElement("tr",null,o.createElement("th",null,"id"),o.createElement("th",null,"OK"),o.createElement("th",null,"owner"),o.createElement("th",null,"name"),o.createElement("th",null,"hash")))},w=function(e){var t=e.data;return o.createElement(S.a,{className:"BuildList",striped:!0,bordered:!0,hover:!0},o.createElement(B,null),o.createElement("tbody",null,t.map((function(e){return o.createElement(U,Object.assign({key:e.buildId},e))}))))},y=n(542),C=n(539),D=n(538),L=Object({NODE_ENV:"production",PUBLIC_URL:""}).AGENT_HOST||"http://localhost",_=Number(Object({NODE_ENV:"production",PUBLIC_URL:""}).SERVER_WS_PORT)||8021,P=Number(Object({NODE_ENV:"production",PUBLIC_URL:""}).SERVER_HTTP_PORT)||3021,k="".concat(L,":").concat(P),M=function(){var e="".concat(k,"/").concat("get_build_results");return fetch("".concat(e)).then((function(e){return e.json()}))},x=function(e){var t="".concat(k,"/").concat("get_build_detailed_result","/").concat(e);return fetch("".concat(t)).then((function(e){return e.json()}))},H=function(e,t,n){var a="".concat(k,"/").concat("build","/").concat(encodeURIComponent(e),"/").concat(t,"/").concat(n);return fetch("".concat(a)).then((function(e){return e.json()}))},V=function(e){var t=e.sendData,n=void 0===t?H:t,a=Object(o.useState)(""),c=Object(m.a)(a,2),l=c[0],r=c[1],u=Object(o.useState)(""),s=Object(m.a)(u,2),i=s[0],d=s[1],E=Object(o.useState)(""),b=Object(m.a)(E,2),f=b[0],h=b[1];return o.createElement(y.a,{className:"BuildForm"},o.createElement(y.a.Body,null,o.createElement(C.a,null,o.createElement(C.a.Group,{controlId:"formBasicEmail"},o.createElement(C.a.Label,null,"repository url"),o.createElement(C.a.Control,{value:l,onChange:function(e){return r(e.currentTarget.value)},type:"text",placeholder:"https://github.com/fosemberg/fosemberg-ci.git"})),o.createElement(C.a.Group,{controlId:"formBasicEmail"},o.createElement(C.a.Label,null,"branch or commit hash"),o.createElement(C.a.Control,{value:i,onChange:function(e){return d(e.currentTarget.value)},type:"text",placeholder:"master"})),o.createElement(C.a.Group,{controlId:"exampleForm.ControlTextarea1"},o.createElement(C.a.Label,null,"command"),o.createElement(C.a.Control,{value:f,onChange:function(e){return h(e.currentTarget.value)},as:"textarea",rows:"3",placeholder:"npm run build"})),o.createElement(D.a,{onClick:function(e){e.preventDefault(),n(l,i,f),r(""),d(""),h("")},variant:"primary",type:"submit"},"Run build"))))},Y=(n(229),function(){return u.a.createElement("div",null,"Loading...")}),$=n(46),A=(n(188),new(function(){function e(){var t=this;Object(h.a)(this,e),this.host="ws://localhost:".concat(_,"/"),this.ws=void 0,this.subject$=new $.Observable,this.in$=new $.Subject,this.out$=new $.Subject,this.onReady=function(){},this.isReady=!1,this.ws=new WebSocket(this.host),window.ws=this.ws,this.ws.onopen=function(){console.log("\u0421\u043e\u0435\u0434\u0438\u043d\u0435\u043d\u0438\u0435 \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u043e."),t.subject$=$.Observable.create((function(e){t.ws.onmessage=function(n){var a=JSON.parse(n.data);e.next(a),t.in$.next(a)},t.ws.onerror=e.error,t.ws.onclose=e.complete})).share(),t.out$.subscribe((function(e){return t.ws.send(e.toString())})),t.isReady=!0,t.onReady()},this.ws.onclose=function(e){t.wsCloseHandler(e)},this.ws.onerror=function(e){alert("\u041e\u0448\u0438\u0431\u043a\u0430 "+e.message)}}return Object(p.a)(e,[{key:"wsCloseHandler",value:function(e){e.wasClean?console.log("\u0421\u043e\u0435\u0434\u0438\u043d\u0435\u043d\u0438\u0435 \u0437\u0430\u043a\u0440\u044b\u0442\u043e \u0447\u0438\u0441\u0442\u043e"):console.log("\u041e\u0431\u0440\u044b\u0432 \u0441\u043e\u0435\u0434\u0438\u043d\u0435\u043d\u0438\u044f"),console.log("\u041a\u043e\u0434: "+e.code+" \u043f\u0440\u0438\u0447\u0438\u043d\u0430: "+e.reason)}}]),e}())),G=function(e){function t(e){var n;return Object(h.a)(this,t),(n=Object(g.a)(this,Object(O.a)(t).call(this,e))).state={data:[]},n}return Object(v.a)(t,e),Object(p.a)(t,[{key:"componentWillMount",value:function(){var e=this;(0,this.props.getData)().then((function(t){return e.setState({data:t})})),A.subject$.subscribe((function(t){if(console.log("message from Subscribe: ",t),t.type===c.EVENT)if(t.action===l.START_BUILD){console.log("get",t);var n=t.body;e.setState({data:[n].concat(Object(f.a)(e.state.data))})}else if(t.action===l.BUILD_RESULT){console.log("get",t);var a=t.body;e.setState({data:e.state.data.map((function(e){return e.buildId===a.buildId?a:e}))})}}))}},{key:"render",value:function(){var e=this.state.data;return o.createElement("div",{className:"MainPage"},o.createElement(V,null),0!==e.length?o.createElement(w,{data:e}):o.createElement(Y,null))}}]),t}(o.Component),J=n(540),W=n(543),F=function(){return u.a.createElement(J.a,{collapseOnSelect:!0,expand:"lg",bg:"light",variant:"light"},u.a.createElement(d.b,{className:"navbar-brand",to:"/"},"Fosemberg CI"),u.a.createElement(J.a.Toggle,{"aria-controls":"responsive-navbar-nav"}),u.a.createElement(J.a.Collapse,null,u.a.createElement(W.a,{className:"mr-auto"},u.a.createElement(d.b,{className:"nav-link",to:"/"},"Main"))))},Q=n(544),K=(n(528),Object(j.cn)("BuildDetails-Header")),q=function(e){var t=e.status,n=e.buildId,c=e.commitHash;return o.createElement(y.a.Header,{className:K({building:t===a.building,success:t===a.success,fail:t===a.fail})},o.createElement(R,{status:t}),"  ",n," - ",c)},z=n(95),X=n.n(z),Z=Object(j.cn)("BuildDetails"),ee=function(e){var t=e.buildId,n=e.repositoryUrl,c=e.commitHash,l=e.command,r=e.status,u=e.stdOut,s=e.startDate,i=e.endDate;return o.createElement(y.a,{className:Z()},o.createElement(q,{status:r,buildId:t,commitHash:c}),o.createElement(Q.a,{variant:"flush"},o.createElement(Q.a.Item,null,"url: ",n),o.createElement(Q.a.Item,null,"command: ",l),o.createElement(Q.a.Item,null,"start build: ",X()(s).format("DD MMM YYYY hh:mm a")),r!==a.building&&o.createElement(Q.a.Item,null,"end build: ",X()(i).format("DD MMM YYYY hh:mm a")),r!==a.building&&o.createElement(Q.a.Item,null,"std out: ",o.createElement("br",null),o.createElement("pre",null,u))))},te=(n(530),Object(j.cn)("BuildPage")),ne=function(e){function t(e){var n;return Object(h.a)(this,t),(n=Object(g.a)(this,Object(O.a)(t).call(this,e))).state={data:{}},n}return Object(v.a)(t,e),Object(p.a)(t,[{key:"componentWillMount",value:function(){var e=this,t=this.props;(0,t.getData)(t.match.params.id).then((function(t){return e.setState({data:t})})),A.subject$.subscribe((function(t){if(console.log("message from Subscribe: ",t),t.type===c.EVENT&&t.action===l.BUILD_RESULT){console.log("get",t);var n=t.body;e.setState({data:n})}}))}},{key:"render",value:function(){var e,t=this.state.data;return o.createElement("div",{className:te()},(e=t,"{}"===JSON.stringify(e)?o.createElement(Y,null):o.createElement(ee,t)))}}]),t}(o.Component),ae=Object(E.g)(ne),ce=Object(j.cn)("Theme"),le=(n(531),n(532),function(){var e=Object(o.useState)(!1),t=Object(m.a)(e,2),n=t[0],a=t[1];return Object(o.useEffect)((function(){A.isReady?a(!0):A.onReady=function(){return a(!0)}}),[]),n?u.a.createElement(d.a,{basename:""},u.a.createElement(b.a,{className:ce({color:"project-default",space:"default"},["p-3"])},u.a.createElement(F,null),u.a.createElement(E.c,null,u.a.createElement(E.a,{path:"/",exact:!0,component:function(){return u.a.createElement(G,{getData:M})}}),u.a.createElement(E.a,{path:"/build/:id",component:function(){return u.a.createElement(ae,{getData:x})}})))):u.a.createElement(Y,null)});n(533);Object(r.config)(),i.a.render(u.a.createElement(le,null),document.getElementById("root"))}},[[214,1,2]]]);
//# sourceMappingURL=main.25623da7.chunk.js.map