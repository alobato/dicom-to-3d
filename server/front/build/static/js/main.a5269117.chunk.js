(this.webpackJsonpfront=this.webpackJsonpfront||[]).push([[0],{216:function(e,t,n){e.exports=n(530)},223:function(e,t,n){},225:function(e,t,n){},231:function(e,t,n){},524:function(e,t,n){},526:function(e,t,n){},527:function(e,t,n){},528:function(e,t,n){},530:function(e,t,n){"use strict";n.r(t);var a,c,l,r=n(206),o=n(0),s=n.n(o),u=n(64),i=n.n(u),m=n(46),d=n(44),E=n(19),b=n(214),f=n(215),h=n(30),O=n(31),S=n(72),v=n(66),g=n(73),p=n(533),N=(n(223),n(18));!function(e){e[e.success=0]="success",e[e.fail=1]="fail",e[e.building=2]="building"}(a||(a={})),function(e){e.SUBSCRIBE="SUBSCRIBE",e.SUBSCRIPTION="SUBSCRIPTION",e.UNSUBSCRIPTION="UNSUBSCRIPTION",e.REQUEST="REQUEST",e.RESPONSE="RESPONSE",e.EVENT="EVENT"}(c||(c={})),function(e){e.START_BUILD="START_BUILD",e.BUILD_RESULT="BUILD_RESULT",e.BUILD_RESULTS="BUILD_RESULTS"}(l||(l={}));var j,I=n(537),T=(n(225),Object(N.cn)("StatusIcon")),R=function(e){var t=e.status;return s.a.createElement("span",{className:T()},t===a.building?s.a.createElement(I.a,{className:T({MdAutorenew:!0})}):t===a.success?s.a.createElement(I.b,null):t===a.fail?s.a.createElement(I.c,null):s.a.createElement("div",null))},C=Object(N.cn)("BuildTable-Row"),U=function(e){var t=e.id,n=e.status,c=e.commitHash,l=Object(E.f)().push;return o.createElement("tr",{onClick:function(){return l("build/".concat(t))},className:C({success:n===a.success,fail:n===a.fail,building:n===a.building})},o.createElement("td",null,t),o.createElement("td",null,o.createElement(R,{status:n})),o.createElement("td",null,c))},B=function(){return o.createElement("thead",null,o.createElement("tr",null,o.createElement("th",null,"id"),o.createElement("th",null,"OK"),o.createElement("th",null,"commit hash")))},L=function(e){var t=e.data;return o.createElement(p.a,{className:"BuildList",striped:!0,bordered:!0,hover:!0},o.createElement(B,null),o.createElement("tbody",null,t.map((function(e){var t=e.buildId,n=e.status,a=e.commitHash;return o.createElement(U,{key:t,id:t,status:n,commitHash:a})}))))},w=n(538),D=n(535),y=n(534),_=Object({NODE_ENV:"production",PUBLIC_URL:""}).AGENT_HOST||"http://localhost",P=Number(Object({NODE_ENV:"production",PUBLIC_URL:""}).SERVER_WS_PORT)||8021,k=Number(Object({NODE_ENV:"production",PUBLIC_URL:""}).SERVER_HTTP_PORT)||3021,H="".concat(_,":").concat(k),M=function(){var e="".concat(H,"/").concat("get_build_results");return fetch("".concat(e)).then((function(e){return e.json()}))},x=function(e){var t="".concat(H,"/").concat("get_build_detailed_result","/").concat(e);return fetch("".concat(t)).then((function(e){return e.json()}))},V=function(e,t){var n="".concat(H,"/").concat("build","/").concat(e,"/").concat(t);return fetch("".concat(n)).then((function(e){return e.json()}))},Y=function(e){var t=e.sendData,n=void 0===t?V:t,a=Object(o.useState)(""),c=Object(m.a)(a,2),l=c[0],r=c[1],s=Object(o.useState)(""),u=Object(m.a)(s,2),i=u[0],d=u[1];return o.createElement(w.a,{className:"BuildForm"},o.createElement(w.a.Body,null,"This is some text within a card body.",o.createElement(D.a,null,o.createElement(D.a.Group,{controlId:"formBasicEmail"},o.createElement(D.a.Label,null,"commit hash"),o.createElement(D.a.Control,{value:l,onChange:function(e){return r(e.currentTarget.value)},type:"text",placeholder:"hash commit"})),o.createElement(D.a.Group,{controlId:"exampleForm.ControlTextarea1"},o.createElement(D.a.Label,null,"command"),o.createElement(D.a.Control,{value:i,onChange:function(e){return d(e.currentTarget.value)},as:"textarea",rows:"3"})),o.createElement(y.a,{onClick:function(e){e.preventDefault(),n(l,i),r(""),d("")},variant:"primary",type:"submit"},"Run build"))))},$=(n(231),function(){return s.a.createElement("div",null,"Loading...")}),G=n(47);n(190);!function(e){e[e.CONNECTING=0]="CONNECTING",e[e.OPEN=1]="OPEN",e[e.CLOSING=2]="CLOSING",e[e.CLOSED=3]="CLOSED"}(j||(j={}));var A=new(function(){function e(){var t=this;Object(h.a)(this,e),this.host="ws://localhost:".concat(P,"/"),this.ws=void 0,this.subject$=new G.Observable,this.in$=new G.Subject,this.out$=new G.Subject,this.onReady=function(){},this.isReady=!1,this.ws=new WebSocket(this.host),window.ws=this.ws,this.ws.onopen=function(){console.log("\u0421\u043e\u0435\u0434\u0438\u043d\u0435\u043d\u0438\u0435 \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u043e."),t.subject$=G.Observable.create((function(e){t.ws.onmessage=function(n){var a=JSON.parse(n.data);e.next(a),t.in$.next(a)},t.ws.onerror=e.error,t.ws.onclose=e.complete})).share(),t.out$.subscribe((function(e){return t.ws.send(e.toString())})),t.isReady=!0,t.onReady()},this.ws.onclose=function(e){t.wsCloseHandler(e)},this.ws.onerror=function(e){alert("\u041e\u0448\u0438\u0431\u043a\u0430 "+e.message)}}return Object(O.a)(e,[{key:"wsCloseHandler",value:function(e){e.wasClean?console.log("\u0421\u043e\u0435\u0434\u0438\u043d\u0435\u043d\u0438\u0435 \u0437\u0430\u043a\u0440\u044b\u0442\u043e \u0447\u0438\u0441\u0442\u043e"):console.log("\u041e\u0431\u0440\u044b\u0432 \u0441\u043e\u0435\u0434\u0438\u043d\u0435\u043d\u0438\u044f"),console.log("\u041a\u043e\u0434: "+e.code+" \u043f\u0440\u0438\u0447\u0438\u043d\u0430: "+e.reason)}}]),e}()),J=function(e){function t(e){var n;return Object(h.a)(this,t),(n=Object(S.a)(this,Object(v.a)(t).call(this,e))).state={data:[]},n}return Object(g.a)(t,e),Object(O.a)(t,[{key:"componentWillMount",value:function(){var e=this;(0,this.props.getData)().then((function(t){return e.setState({data:t})})),A.subject$.subscribe((function(t){if(console.log("message from Subscribe: ",t),t.type===c.EVENT)if(t.action===l.START_BUILD){console.log("get",t);var n=t.body;e.setState({data:[n].concat(Object(f.a)(e.state.data))})}else if(t.action===l.BUILD_RESULT){console.log("get",t);var a=t.body;e.setState({data:e.state.data.map((function(e){return e.buildId===a.buildId?a:e}))})}}))}},{key:"render",value:function(){var e=this.state.data;return o.createElement("div",{className:"MainPage"},o.createElement(Y,null),0!==e.length?o.createElement(L,{data:e}):o.createElement($,null))}}]),t}(o.Component),W=n(536),F=n(539),Q=function(){return s.a.createElement(W.a,{collapseOnSelect:!0,expand:"lg",bg:"light",variant:"light"},s.a.createElement(d.b,{className:"navbar-brand",to:"/"},"Fosemberg CI"),s.a.createElement(W.a.Toggle,{"aria-controls":"responsive-navbar-nav"}),s.a.createElement(W.a.Collapse,null,s.a.createElement(F.a,{className:"mr-auto"},s.a.createElement(d.b,{className:"nav-link",to:"/"},"Main"))))},K=n(540),q=(n(524),Object(N.cn)("BuildDetails-Header")),z=function(e){var t=e.status,n=e.buildId,c=e.commitHash;return o.createElement(w.a.Header,{className:q({building:t===a.building,success:t===a.success,fail:t===a.fail})},o.createElement(R,{status:t}),"  ",n," - ",c)},X=n(98),Z=n.n(X),ee=Object(N.cn)("BuildDetails"),te=function(e){var t=e.buildId,n=e.commitHash,c=e.command,l=e.status,r=e.stdOut,s=e.startDate,u=e.endDate;return o.createElement(w.a,{className:ee()},o.createElement(z,{status:l,buildId:t,commitHash:n}),o.createElement(K.a,{variant:"flush"},o.createElement(K.a.Item,null,"command: ",c),o.createElement(K.a.Item,null,"start build: ",Z()(s).format("DD MMM YYYY hh:mm a")),l!==a.building&&o.createElement(K.a.Item,null,"end build: ",Z()(u).format("DD MMM YYYY hh:mm a")),l!==a.building&&o.createElement(K.a.Item,null,"std out: ",r)))},ne=(n(526),Object(N.cn)("BuildPage")),ae=function(e){function t(e){var n;return Object(h.a)(this,t),(n=Object(S.a)(this,Object(v.a)(t).call(this,e))).state={data:{}},n}return Object(g.a)(t,e),Object(O.a)(t,[{key:"componentWillMount",value:function(){var e=this,t=this.props;(0,t.getData)(t.match.params.id).then((function(t){return e.setState({data:t})})),A.subject$.subscribe((function(t){if(console.log("message from Subscribe: ",t),t.type===c.EVENT&&t.action===l.BUILD_RESULT){console.log("get",t);var n=t.body;e.setState({data:n})}}))}},{key:"render",value:function(){var e,t=this.state.data;return o.createElement("div",{className:ne()},(e=t,"{}"===JSON.stringify(e)?o.createElement($,null):o.createElement(te,t)))}}]),t}(o.Component),ce=Object(E.g)(ae),le=Object(N.cn)("Theme"),re=(n(527),n(528),function(){var e=Object(o.useState)(!1),t=Object(m.a)(e,2),n=t[0],a=t[1];return Object(o.useEffect)((function(){A.isReady?a(!0):A.onReady=function(){return a(!0)}}),[]),n?s.a.createElement(d.a,{basename:""},s.a.createElement(b.a,{className:le({color:"project-default",space:"default"},["p-3"])},s.a.createElement(Q,null),s.a.createElement(E.c,null,s.a.createElement(E.a,{path:"/",exact:!0,component:function(){return s.a.createElement(J,{getData:M})}}),s.a.createElement(E.a,{path:"/build/:id",component:function(){return s.a.createElement(ce,{getData:x})}})))):s.a.createElement($,null)});n(529);Object(r.config)(),i.a.render(s.a.createElement(re,null),document.getElementById("root"))}},[[216,1,2]]]);
//# sourceMappingURL=main.a5269117.chunk.js.map